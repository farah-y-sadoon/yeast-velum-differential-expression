
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FASTQ Summary Report</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/modern-normalize/2.0.0/modern-normalize.min.css">
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f8f9fa; margin: 0; padding: 2em; }
        h1 { color: #2c3e50; }
        table { border-collapse: collapse; width: 100%; margin-bottom: 2em; background: #fff; }
        th, td { border: 1px solid #e1e4e8; padding: 0.75em 1em; text-align: center; }
        th { background: #f3f6fa; color: #34495e; }
        tr:nth-child(even) { background: #f9fafb; }
        a { color: #2980b9; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .chart-container { width: 100%; max-width: none; aspect-ratio: 4/1; }
        .row-charts-table { width: 100%; margin-bottom: 2em; background: none; border: none; }
        .row-charts-table td { border: none; vertical-align: top; width: 50%; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <h2>FASTQ Aggregate Summary (fastp 1.1.0)</h2>
    <table>
        <thead>
            <tr>
                <th>File</th>
                <th>Total Reads (Before)</th>
                <th>Total Reads (After)</th>
                <th>Total Bases (Before)</th>
                <th>Total Bases (After)</th>
                <th>Q20 Rate (Before)</th>
                <th>Q20 Rate (After)</th>
                <th>Q30 Rate (Before)</th>
                <th>Q30 Rate (After)</th>
                <th>GC Content (Before)</th>
                <th>GC Content (After)</th>
                <th>HTML Report</th>
            </tr>
        </thead>
        <tbody>
<tr><td>SRpe0551662.fastq.gz</td><td>6.31M</td><td>6.02M</td><td>315.46M</td><td>300.95M</td><td>98.22%</td><td>99.22%</td><td>96.85%</td><td>98.43%</td><td>45.19%</td><td>45.17%</td><td><a href="SRpe0551662.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551661.fastq.gz</td><td>6.09M</td><td>5.76M</td><td>304.48M</td><td>288.09M</td><td>97.86%</td><td>99.21%</td><td>96.47%</td><td>98.41%</td><td>41.61%</td><td>41.84%</td><td><a href="SRpe0551661.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551658.fastq.gz</td><td>6.91M</td><td>6.59M</td><td>345.60M</td><td>329.57M</td><td>98.04%</td><td>99.16%</td><td>96.77%</td><td>98.41%</td><td>42.15%</td><td>42.33%</td><td><a href="SRpe0551658.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551665.fastq.gz</td><td>7.53M</td><td>7.15M</td><td>376.40M</td><td>357.29M</td><td>98.09%</td><td>99.21%</td><td>96.67%</td><td>98.42%</td><td>43.62%</td><td>43.72%</td><td><a href="SRpe0551665.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551664.fastq.gz</td><td>6.90M</td><td>6.53M</td><td>344.88M</td><td>326.70M</td><td>97.97%</td><td>99.21%</td><td>96.56%</td><td>98.42%</td><td>43.37%</td><td>43.52%</td><td><a href="SRpe0551664.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551659.fastq.gz</td><td>8.77M</td><td>8.38M</td><td>438.26M</td><td>418.78M</td><td>98.14%</td><td>99.17%</td><td>96.86%</td><td>98.40%</td><td>42.88%</td><td>43.00%</td><td><a href="SRpe0551659.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551660.fastq.gz</td><td>5.98M</td><td>5.66M</td><td>299.04M</td><td>283.22M</td><td>97.84%</td><td>99.23%</td><td>96.48%</td><td>98.46%</td><td>41.18%</td><td>41.30%</td><td><a href="SRpe0551660.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551663.fastq.gz</td><td>6.73M</td><td>6.39M</td><td>336.75M</td><td>319.42M</td><td>98.03%</td><td>99.22%</td><td>96.64%</td><td>98.44%</td><td>43.50%</td><td>43.65%</td><td><a href="SRpe0551663.fastq.gz.html">View</a></td></tr><tr><td>SRpe0551657.fastq.gz</td><td>9.03M</td><td>8.61M</td><td>451.54M</td><td>430.29M</td><td>98.02%</td><td>99.15%</td><td>96.73%</td><td>98.37%</td><td>42.17%</td><td>42.39%</td><td><a href="SRpe0551657.fastq.gz.html">View</a></td></tr>
        </tbody>
    </table>
    <table class="row-charts-table">
        <tr>
            <td><div id="meanQualPlotBefore" style="width:100%;height:400px;"></div></td>
            <td><div id="meanQualPlotAfter" style="width:100%;height:400px;"></div></td>
        </tr>
        <tr>
            <td><div id="gcCurvePlotBefore" style="width:100%;height:400px;"></div></td>
            <td><div id="gcCurvePlotAfter" style="width:100%;height:400px;"></div></td>
        </tr>
    </table>

    <div class="chart-container" style="width:100%; max-width:none; aspect-ratio: 4/1;">
        <canvas id="qRateChart" style="height:200px;"></canvas>
    </div>
    <script>
        const files = ["SRpe0551662.fastq.gz", "SRpe0551661.fastq.gz", "SRpe0551658.fastq.gz", "SRpe0551665.fastq.gz", "SRpe0551664.fastq.gz", "SRpe0551659.fastq.gz", "SRpe0551660.fastq.gz", "SRpe0551663.fastq.gz", "SRpe0551657.fastq.gz"];
        const totalReadsBefore = [6309292, 6089675, 6912070, 7528054, 6897699, 8765210, 5980833, 6734945, 9030851];
        const totalReadsAfter = [6018999, 5761724, 6591390, 7145803, 6534074, 8375559, 5664357, 6388396, 8605791];
        const totalBasesBefore = [315464600, 304483750, 345603500, 376402700, 344884950, 438260500, 299041650, 336747250, 451542550];
        const totalBasesAfter = [300949950, 288086200, 329569500, 357290150, 326703700, 418777950, 283217850, 319419800, 430289550];
        const q20Before = [98.2242, 97.8631, 98.04230000000001, 98.0877, 97.9711, 98.1356, 97.84469999999999, 98.0259, 98.0218];
        const q20After = [99.2154, 99.2067, 99.161, 99.2135, 99.2139, 99.1658, 99.22579999999999, 99.2191, 99.1477];
        const q30Before = [96.8537, 96.4704, 96.7727, 96.6742, 96.5554, 96.8575, 96.4793, 96.6356, 96.7317];
        const q30After = [98.4342, 98.41159999999999, 98.4064, 98.4215, 98.4226, 98.4016, 98.4604, 98.4411, 98.37129999999999];
        // Plotly mean quality curves (before)
        const meanQualCurves = [{"file": "SRpe0551662.fastq.gz", "curve_before": [36.4164, 36.4172, 36.4183, 36.1786, 36.3452, 37.3791, 37.7993, 38.1253, 38.2962, 38.3461, 38.3609, 38.3755, 38.3795, 38.3531, 38.353, 38.3334, 38.3097, 38.3028, 38.3201, 38.3282, 38.3209, 38.3397, 38.3147, 38.3167, 38.299, 38.2495, 38.2385, 38.2139, 38.2043, 38.1615, 38.1345, 38.1259, 38.1116, 38.0978, 38.0985, 38.127, 38.0849, 38.0697, 38.0463, 38.0327, 38.0255, 38.0071, 37.9756, 37.9672, 37.9476, 37.9113, 37.861, 37.8228, 37.7273, 36.8448], "curve_after": [36.753, 36.7458, 36.7435, 36.5142, 36.6731, 37.7459, 38.1514, 38.4776, 38.6472, 38.6946, 38.7117, 38.726, 38.7328, 38.7115, 38.711, 38.6953, 38.6796, 38.6791, 38.6957, 38.6999, 38.6958, 38.7095, 38.6859, 38.6949, 38.6863, 38.6642, 38.6584, 38.6422, 38.6393, 38.6054, 38.586, 38.583, 38.5756, 38.5622, 38.5666, 38.5982, 38.5588, 38.5526, 38.5332, 38.5273, 38.5284, 38.5188, 38.4984, 38.499, 38.4945, 38.4751, 38.4492, 38.446, 38.3983, 37.582]}, {"file": "SRpe0551661.fastq.gz", "curve_before": [36.3513, 36.3889, 36.4045, 36.0935, 36.379, 37.404, 37.7921, 38.1015, 38.2748, 38.3157, 38.3318, 38.3419, 38.3361, 38.3447, 38.3349, 38.331, 38.2836, 38.2761, 38.2796, 38.281, 38.2712, 38.2954, 38.258, 38.2583, 38.2296, 38.1783, 38.1657, 38.1308, 38.1187, 38.042, 38.0037, 37.9832, 37.9324, 37.932, 37.8924, 37.9004, 37.8353, 37.8122, 37.7829, 37.759, 37.7452, 37.7254, 37.6827, 37.6579, 37.6325, 37.6012, 37.5706, 37.5159, 37.4159, 36.9522], "curve_after": [36.7208, 36.7435, 36.7534, 36.4566, 36.7328, 37.8033, 38.1791, 38.4917, 38.6638, 38.705, 38.7246, 38.736, 38.7349, 38.7482, 38.742, 38.7444, 38.7081, 38.7091, 38.7144, 38.7134, 38.7085, 38.7277, 38.695, 38.7066, 38.6938, 38.6741, 38.6742, 38.6597, 38.6619, 38.6108, 38.5945, 38.5948, 38.572, 38.5875, 38.569, 38.5982, 38.549, 38.5468, 38.5332, 38.5271, 38.528, 38.5199, 38.4914, 38.4803, 38.4724, 38.4591, 38.4521, 38.43, 38.3735, 37.9713]}, {"file": "SRpe0551658.fastq.gz", "curve_before": [36.5675, 36.5725, 36.5916, 36.6058, 36.313, 37.3557, 37.8365, 38.1805, 38.3522, 38.4201, 38.4116, 38.4239, 38.4562, 38.3084, 38.3293, 38.2629, 38.3266, 38.2915, 38.3576, 38.3877, 38.3939, 38.3759, 38.3795, 38.372, 38.3722, 38.3003, 38.2543, 38.2328, 38.2081, 38.1802, 38.165, 38.136, 38.1313, 38.018, 38.0353, 38.0479, 38.0187, 37.9657, 37.9462, 37.9082, 37.86, 37.8152, 37.7984, 37.7678, 37.7254, 37.6702, 37.5221, 37.5246, 37.4252, 35.2145], "curve_after": [36.8723, 36.8677, 36.8781, 36.8953, 36.6186, 37.6942, 38.162, 38.5002, 38.6749, 38.7434, 38.7396, 38.7593, 38.7898, 38.6457, 38.6665, 38.6072, 38.676, 38.6445, 38.7124, 38.7469, 38.7534, 38.7404, 38.7434, 38.7443, 38.7471, 38.7081, 38.6773, 38.6677, 38.6584, 38.6481, 38.6468, 38.6346, 38.6449, 38.5444, 38.5775, 38.6094, 38.5996, 38.5706, 38.567, 38.5505, 38.5161, 38.4853, 38.4785, 38.4597, 38.4334, 38.3947, 38.269, 38.3037, 38.2515, 36.0964]}, {"file": "SRpe0551665.fastq.gz", "curve_before": [36.3583, 36.3786, 36.3911, 36.0824, 36.3634, 37.3915, 37.7958, 38.1123, 38.2814, 38.3312, 38.3504, 38.3561, 38.3588, 38.3631, 38.3565, 38.3526, 38.3093, 38.3008, 38.304, 38.3067, 38.2984, 38.326, 38.2946, 38.2976, 38.2705, 38.2196, 38.2169, 38.1932, 38.1834, 38.1142, 38.0724, 38.0657, 38.0265, 38.0332, 38.0124, 38.0279, 37.9791, 37.9596, 37.9376, 37.9143, 37.9132, 37.895, 37.8519, 37.8402, 37.8154, 37.8016, 37.7733, 37.725, 37.6225, 37.1431], "curve_after": [36.7093, 36.7152, 36.7242, 36.428, 36.6981, 37.7694, 38.1607, 38.4788, 38.6458, 38.6932, 38.7155, 38.7203, 38.7262, 38.7357, 38.7293, 38.7304, 38.697, 38.6962, 38.6988, 38.6983, 38.6934, 38.7146, 38.6862, 38.6983, 38.6856, 38.6634, 38.6679, 38.6589, 38.6581, 38.6066, 38.5795, 38.5851, 38.5645, 38.5794, 38.5703, 38.5983, 38.5558, 38.5492, 38.5364, 38.525, 38.5349, 38.5258, 38.4959, 38.4954, 38.4875, 38.4902, 38.4859, 38.4713, 38.4166, 38.0069]}, {"file": "SRpe0551664.fastq.gz", "curve_before": [36.3625, 36.3885, 36.4013, 36.0904, 36.3697, 37.3917, 37.7879, 38.104, 38.2732, 38.3199, 38.3393, 38.3476, 38.3479, 38.3504, 38.3429, 38.3386, 38.2909, 38.2821, 38.2842, 38.2877, 38.2763, 38.3036, 38.2709, 38.2715, 38.2399, 38.1896, 38.1851, 38.1604, 38.1503, 38.0771, 38.0345, 38.0212, 37.9768, 37.9801, 37.9549, 37.9655, 37.9143, 37.8955, 37.8757, 37.8509, 37.8381, 37.8152, 37.7692, 37.7565, 37.7322, 37.7132, 37.6795, 37.6256, 37.5251, 37.0446], "curve_after": [36.7286, 36.7409, 36.751, 36.4511, 36.7213, 37.7905, 38.1742, 38.4932, 38.6608, 38.7053, 38.729, 38.7356, 38.7399, 38.749, 38.7412, 38.7432, 38.7065, 38.7061, 38.7083, 38.7097, 38.7008, 38.7224, 38.6931, 38.7061, 38.6886, 38.6707, 38.6755, 38.6651, 38.6654, 38.612, 38.5896, 38.5894, 38.5661, 38.5816, 38.5705, 38.5975, 38.5556, 38.553, 38.5446, 38.5316, 38.5347, 38.5219, 38.4912, 38.4889, 38.4834, 38.4827, 38.4745, 38.4539, 38.4012, 37.9879]}, {"file": "SRpe0551659.fastq.gz", "curve_before": [36.6011, 36.6152, 36.6219, 36.6408, 36.346, 37.3821, 37.8689, 38.2094, 38.3666, 38.4292, 38.4259, 38.4435, 38.4795, 38.3254, 38.3475, 38.2851, 38.3467, 38.3095, 38.3729, 38.4032, 38.4088, 38.389, 38.3965, 38.3859, 38.3801, 38.3073, 38.2602, 38.2393, 38.2182, 38.1949, 38.1869, 38.1605, 38.1578, 38.0563, 38.0765, 38.0948, 38.0674, 38.0206, 38.0031, 37.9699, 37.9236, 37.8812, 37.8695, 37.835, 37.7956, 37.7449, 37.5951, 37.5944, 37.4939, 35.251], "curve_after": [36.896, 36.9006, 36.9008, 36.9201, 36.6398, 37.7094, 38.1816, 38.5177, 38.6785, 38.7411, 38.7428, 38.7664, 38.7999, 38.6514, 38.6714, 38.6154, 38.6825, 38.6475, 38.713, 38.7463, 38.7539, 38.7392, 38.7452, 38.7439, 38.7398, 38.6992, 38.6651, 38.6557, 38.6455, 38.637, 38.6394, 38.6245, 38.6335, 38.5384, 38.5705, 38.6031, 38.5901, 38.5633, 38.5616, 38.5449, 38.5108, 38.4821, 38.4789, 38.4575, 38.4321, 38.3972, 38.2704, 38.3021, 38.2492, 36.0657]}, {"file": "SRpe0551660.fastq.gz", "curve_before": [36.3066, 36.34, 36.3655, 36.0634, 36.3384, 37.3712, 37.7522, 38.0602, 38.2268, 38.2726, 38.2891, 38.3057, 38.3064, 38.306, 38.3032, 38.2986, 38.2523, 38.2451, 38.2504, 38.2511, 38.2328, 38.2637, 38.2301, 38.2244, 38.208, 38.1559, 38.1458, 38.1243, 38.114, 38.052, 38.013, 38.0018, 37.9601, 37.9602, 37.9385, 37.949, 37.8907, 37.8703, 37.8507, 37.8256, 37.8222, 37.8024, 37.7583, 37.7436, 37.726, 37.6929, 37.6642, 37.6146, 37.5158, 37.05], "curve_after": [36.7185, 36.7384, 36.7587, 36.468, 36.7355, 37.8165, 38.1865, 38.497, 38.6637, 38.7079, 38.7288, 38.7447, 38.748, 38.7544, 38.7519, 38.7523, 38.7171, 38.7187, 38.7232, 38.7214, 38.7083, 38.7348, 38.7055, 38.7109, 38.7074, 38.6873, 38.6877, 38.6799, 38.6829, 38.6391, 38.6179, 38.6214, 38.6005, 38.6114, 38.6058, 38.6304, 38.5816, 38.5781, 38.5704, 38.5614, 38.5696, 38.558, 38.5274, 38.5258, 38.5215, 38.5094, 38.5026, 38.4849, 38.4309, 38.0313]}, {"file": "SRpe0551663.fastq.gz", "curve_before": [36.3589, 36.3771, 36.3945, 36.0888, 36.3723, 37.4004, 37.8008, 38.1167, 38.2866, 38.3404, 38.3573, 38.3653, 38.3655, 38.3692, 38.3617, 38.357, 38.308, 38.2985, 38.3027, 38.3025, 38.2917, 38.319, 38.288, 38.2876, 38.2606, 38.2115, 38.2042, 38.1833, 38.1758, 38.1068, 38.0653, 38.0508, 38.0151, 38.0151, 37.9962, 38.0066, 37.9547, 37.9352, 37.9129, 37.8849, 37.8784, 37.8511, 37.8086, 37.7942, 37.7724, 37.753, 37.7243, 37.6697, 37.5679, 37.0951], "curve_after": [36.7132, 36.7201, 36.7333, 36.4405, 36.713, 37.7857, 38.1727, 38.4904, 38.6597, 38.7116, 38.731, 38.7386, 38.7436, 38.7532, 38.7477, 38.7472, 38.7094, 38.708, 38.7126, 38.7104, 38.7035, 38.7245, 38.698, 38.7095, 38.6948, 38.6774, 38.6791, 38.672, 38.6748, 38.6241, 38.5994, 38.5987, 38.5808, 38.5926, 38.5847, 38.6124, 38.5688, 38.5644, 38.5537, 38.5404, 38.5464, 38.5297, 38.5025, 38.5003, 38.4943, 38.4944, 38.4887, 38.4686, 38.4134, 38.0068]}, {"file": "SRpe0551657.fastq.gz", "curve_before": [36.5817, 36.6052, 36.6087, 36.6273, 36.3291, 37.3724, 37.853, 38.1898, 38.3481, 38.4136, 38.4064, 38.4137, 38.4479, 38.3058, 38.3321, 38.2625, 38.3289, 38.288, 38.3477, 38.3807, 38.3918, 38.3737, 38.3723, 38.3691, 38.3636, 38.2846, 38.2405, 38.215, 38.1933, 38.1574, 38.1395, 38.1103, 38.1, 37.9852, 37.9984, 38.0024, 37.9716, 37.9176, 37.8966, 37.8537, 37.8075, 37.7691, 37.7495, 37.713, 37.6641, 37.6152, 37.458, 37.4596, 37.3665, 35.1381], "curve_after": [36.8796, 36.8918, 36.887, 36.9076, 36.6262, 37.7034, 38.1695, 38.5018, 38.6628, 38.7286, 38.7269, 38.7421, 38.7743, 38.6357, 38.6597, 38.5986, 38.67, 38.6331, 38.6957, 38.7301, 38.7423, 38.7281, 38.7295, 38.7325, 38.7319, 38.6851, 38.6559, 38.6435, 38.6368, 38.6223, 38.621, 38.6115, 38.6198, 38.5187, 38.5503, 38.5776, 38.5679, 38.5401, 38.538, 38.5174, 38.4853, 38.4594, 38.4517, 38.428, 38.3949, 38.3615, 38.2276, 38.2618, 38.2151, 36.0377]}];
        const maxLenBefore = 50;
        const maxLenAfter = 50;
        const qualLabelsBefore = Array.from({length: maxLenBefore}, (_, i) => i + 1);
        const qualLabelsAfter = Array.from({length: maxLenAfter}, (_, i) => i + 1);
        const plotlyTracesBefore = meanQualCurves.map((item, idx) => {
            const before = item.curve_before || [];
            const beforePad = before.concat(Array(maxLenBefore - before.length).fill(null));
            return {
                x: qualLabelsBefore,
                y: beforePad,
                mode: 'lines',
                name: item.file,
                line: { width: 1 }
            };
        });
        Plotly.newPlot('meanQualPlotBefore', plotlyTracesBefore, {
            title: 'Mean Quality Curve (Read1, Before Filtering)',
            xaxis: { title: '' },
            yaxis: { title: 'Mean Quality', rangemode: 'tozero' },
            legend: { orientation: 'h' },
            margin: { t: 50, l: 60, r: 30, b: 60 }
        }, {responsive: true});
        // Plotly mean quality curves (after)
        const plotlyTracesAfter = meanQualCurves.map((item, idx) => {
            const after = item.curve_after || [];
            const afterPad = after.concat(Array(maxLenAfter - after.length).fill(null));
            return {
                x: qualLabelsAfter,
                y: afterPad,
                mode: 'lines',
                name: item.file,
                line: { width: 1 }
            };
        });
        Plotly.newPlot('meanQualPlotAfter', plotlyTracesAfter, {
            title: 'Mean Quality Curve (Read1, After Filtering)',
            xaxis: { title: '' },
            yaxis: { title: 'Mean Quality', rangemode: 'tozero' },
            legend: { orientation: 'h' },
            margin: { t: 50, l: 60, r: 30, b: 60 }
        }, {responsive: true});
        // Plotly GC content curves (before)
        const gcCurves = [{"file": "SRpe0551662.fastq.gz", "curve_before": [0.699692, 0.450854, 0.499546, 0.476628, 0.413466, 0.363697, 0.382702, 0.491639, 0.467821, 0.403063, 0.509513, 0.484439, 0.406248, 0.419295, 0.463857, 0.469118, 0.443932, 0.450396, 0.464126, 0.441194, 0.449561, 0.45594, 0.44078, 0.43178, 0.439703, 0.449121, 0.453695, 0.454749, 0.450268, 0.446154, 0.45047, 0.462188, 0.467681, 0.452227, 0.430413, 0.459922, 0.452537, 0.452861, 0.439969, 0.421252, 0.445281, 0.443767, 0.45177, 0.449059, 0.439058, 0.430412, 0.42802, 0.455695, 0.439135, 0.449502], "curve_after": [0.700745, 0.451119, 0.499759, 0.476695, 0.413369, 0.36334, 0.382614, 0.491758, 0.46764, 0.402933, 0.509425, 0.484415, 0.406089, 0.419061, 0.463779, 0.468827, 0.443732, 0.450263, 0.463903, 0.441068, 0.449202, 0.45596, 0.440692, 0.431716, 0.439524, 0.448878, 0.453553, 0.454522, 0.449892, 0.445905, 0.450034, 0.461928, 0.467384, 0.45191, 0.430255, 0.459667, 0.452261, 0.452611, 0.439873, 0.421082, 0.445162, 0.443671, 0.4515, 0.448846, 0.438767, 0.430202, 0.427915, 0.455624, 0.439, 0.449349]}, {"file": "SRpe0551661.fastq.gz", "curve_before": [0.666796, 0.407496, 0.454605, 0.442313, 0.377768, 0.336952, 0.351816, 0.454712, 0.434401, 0.357876, 0.462039, 0.44765, 0.374362, 0.380507, 0.413323, 0.431308, 0.405209, 0.415253, 0.429441, 0.402888, 0.416936, 0.413574, 0.403171, 0.405312, 0.408818, 0.413509, 0.417639, 0.414576, 0.422546, 0.40956, 0.421534, 0.422957, 0.426758, 0.414013, 0.394723, 0.419277, 0.418014, 0.415853, 0.411244, 0.389234, 0.410043, 0.409582, 0.42266, 0.413983, 0.405618, 0.401418, 0.397148, 0.415868, 0.40471, 0.416583], "curve_after": [0.67369, 0.411027, 0.458326, 0.445725, 0.380485, 0.338734, 0.354153, 0.458139, 0.437567, 0.360239, 0.465531, 0.451141, 0.37693, 0.383028, 0.416228, 0.434186, 0.408082, 0.418124, 0.432273, 0.405558, 0.419518, 0.416371, 0.405835, 0.407868, 0.411349, 0.41615, 0.420158, 0.417087, 0.424892, 0.411789, 0.42368, 0.425133, 0.428813, 0.415889, 0.396336, 0.420894, 0.419571, 0.417351, 0.412835, 0.390542, 0.411542, 0.410858, 0.424039, 0.41528, 0.406682, 0.402604, 0.39828, 0.417158, 0.406096, 0.418038]}, {"file": "SRpe0551658.fastq.gz", "curve_before": [0.661666, 0.415194, 0.465174, 0.436655, 0.384271, 0.336008, 0.362014, 0.460553, 0.450023, 0.369748, 0.46414, 0.446979, 0.382255, 0.390675, 0.419932, 0.440355, 0.414096, 0.431044, 0.428635, 0.408881, 0.419693, 0.418246, 0.402448, 0.402061, 0.412679, 0.417003, 0.412283, 0.425573, 0.425538, 0.426226, 0.417656, 0.436621, 0.432888, 0.420061, 0.395989, 0.415451, 0.420055, 0.420028, 0.412275, 0.400587, 0.423364, 0.416572, 0.41828, 0.418843, 0.415471, 0.40841, 0.406825, 0.419904, 0.413294, 0.431085], "curve_after": [0.666762, 0.417869, 0.46821, 0.439245, 0.386623, 0.337661, 0.364086, 0.463351, 0.452637, 0.371865, 0.466921, 0.449669, 0.384375, 0.39272, 0.422396, 0.442833, 0.416294, 0.433566, 0.430854, 0.411016, 0.42169, 0.420555, 0.404411, 0.404077, 0.414753, 0.419128, 0.414178, 0.427464, 0.427285, 0.42798, 0.419087, 0.438172, 0.434311, 0.421301, 0.397167, 0.416488, 0.421205, 0.421031, 0.413241, 0.401334, 0.424164, 0.417306, 0.418856, 0.419387, 0.416241, 0.409076, 0.407518, 0.420778, 0.414103, 0.432047]}, {"file": "SRpe0551665.fastq.gz", "curve_before": [0.685609, 0.427971, 0.477045, 0.46052, 0.395853, 0.355271, 0.370257, 0.468623, 0.455443, 0.375263, 0.481144, 0.462979, 0.404778, 0.405696, 0.432636, 0.449149, 0.421535, 0.434597, 0.442103, 0.425003, 0.442241, 0.434544, 0.425841, 0.426878, 0.430673, 0.431865, 0.435235, 0.439747, 0.439342, 0.433008, 0.438221, 0.446758, 0.449883, 0.433823, 0.413293, 0.430714, 0.431891, 0.438548, 0.438444, 0.413948, 0.432621, 0.430029, 0.43375, 0.43903, 0.42459, 0.427026, 0.42204, 0.435198, 0.4232, 0.436555], "curve_after": [0.688823, 0.429416, 0.478459, 0.461909, 0.396951, 0.356029, 0.371253, 0.470015, 0.456822, 0.376185, 0.482616, 0.464441, 0.405848, 0.406643, 0.433863, 0.450353, 0.422678, 0.435734, 0.443214, 0.426015, 0.443273, 0.435914, 0.426947, 0.427994, 0.431607, 0.432937, 0.436266, 0.4407, 0.440228, 0.433884, 0.439009, 0.447604, 0.450752, 0.434525, 0.413973, 0.431278, 0.432488, 0.439127, 0.439199, 0.414485, 0.433133, 0.430505, 0.434205, 0.439527, 0.424844, 0.42755, 0.422584, 0.435696, 0.423819, 0.437154]}, {"file": "SRpe0551664.fastq.gz", "curve_before": [0.677006, 0.425301, 0.47179, 0.456319, 0.394023, 0.353231, 0.368207, 0.46692, 0.453928, 0.372731, 0.478383, 0.459528, 0.402407, 0.403583, 0.429666, 0.446094, 0.418975, 0.432269, 0.439025, 0.423198, 0.440646, 0.430749, 0.423942, 0.423366, 0.426347, 0.428376, 0.432762, 0.43669, 0.436383, 0.430263, 0.436978, 0.443431, 0.446292, 0.431062, 0.411329, 0.42721, 0.428471, 0.43631, 0.436107, 0.41396, 0.431779, 0.430298, 0.43166, 0.435235, 0.421882, 0.425207, 0.420606, 0.433715, 0.422806, 0.436173], "curve_after": [0.681772, 0.427513, 0.474233, 0.458564, 0.395802, 0.354401, 0.369662, 0.469188, 0.456052, 0.374251, 0.480694, 0.461796, 0.40417, 0.405124, 0.431536, 0.447951, 0.420754, 0.434136, 0.440813, 0.424906, 0.442302, 0.432745, 0.425581, 0.425046, 0.427988, 0.429997, 0.434369, 0.438302, 0.437783, 0.431783, 0.43832, 0.444807, 0.447658, 0.432365, 0.412372, 0.428184, 0.429472, 0.437368, 0.437229, 0.414862, 0.432645, 0.431261, 0.432485, 0.436031, 0.422518, 0.425943, 0.421325, 0.434492, 0.423665, 0.437065]}, {"file": "SRpe0551659.fastq.gz", "curve_before": [0.670238, 0.431449, 0.478929, 0.445499, 0.393539, 0.343808, 0.369852, 0.469982, 0.460551, 0.378053, 0.47614, 0.454767, 0.388109, 0.399012, 0.430054, 0.449264, 0.420892, 0.436855, 0.434061, 0.418673, 0.427948, 0.423272, 0.408888, 0.408003, 0.418186, 0.421116, 0.4197, 0.432497, 0.432167, 0.433544, 0.425128, 0.445111, 0.439098, 0.425528, 0.400667, 0.421316, 0.424652, 0.426771, 0.418375, 0.407323, 0.428901, 0.424514, 0.423828, 0.423403, 0.420115, 0.414256, 0.412338, 0.42656, 0.417487, 0.439632], "curve_after": [0.674063, 0.433473, 0.481136, 0.447216, 0.395173, 0.344949, 0.371404, 0.472065, 0.462427, 0.379565, 0.478141, 0.456619, 0.389545, 0.400474, 0.43191, 0.450994, 0.422449, 0.43859, 0.435585, 0.420119, 0.429264, 0.42493, 0.410184, 0.409405, 0.41961, 0.422589, 0.420905, 0.433722, 0.433266, 0.434801, 0.426015, 0.446129, 0.439983, 0.426295, 0.401394, 0.421959, 0.425367, 0.427491, 0.418917, 0.407688, 0.429275, 0.424788, 0.423985, 0.423628, 0.420549, 0.414598, 0.412694, 0.427061, 0.417834, 0.440123]}, {"file": "SRpe0551660.fastq.gz", "curve_before": [0.660745, 0.400974, 0.446451, 0.432631, 0.378069, 0.333756, 0.352362, 0.45121, 0.433994, 0.359581, 0.462216, 0.44304, 0.372827, 0.382654, 0.417378, 0.426578, 0.404575, 0.411648, 0.424352, 0.40161, 0.410254, 0.413577, 0.400484, 0.396025, 0.40225, 0.407806, 0.411258, 0.410496, 0.411903, 0.406674, 0.414257, 0.419219, 0.419592, 0.409628, 0.395071, 0.415735, 0.41527, 0.408795, 0.402743, 0.386179, 0.408709, 0.405394, 0.410912, 0.406462, 0.401467, 0.397853, 0.391349, 0.408881, 0.398457, 0.405955], "curve_after": [0.666455, 0.403332, 0.448934, 0.434801, 0.379598, 0.334361, 0.353496, 0.453209, 0.435849, 0.360612, 0.464289, 0.445083, 0.374094, 0.383879, 0.418914, 0.428171, 0.405926, 0.413086, 0.425908, 0.402964, 0.411542, 0.41512, 0.401749, 0.397245, 0.403591, 0.409055, 0.41241, 0.411742, 0.412955, 0.407681, 0.415257, 0.420203, 0.420551, 0.41046, 0.395692, 0.416379, 0.4159, 0.409331, 0.40351, 0.38677, 0.409312, 0.405898, 0.411315, 0.406932, 0.401735, 0.39828, 0.391665, 0.409302, 0.398959, 0.406524]}, {"file": "SRpe0551663.fastq.gz", "curve_before": [0.67819, 0.427114, 0.474134, 0.457836, 0.395712, 0.35363, 0.368995, 0.469083, 0.455992, 0.375474, 0.480908, 0.461833, 0.403621, 0.405405, 0.433086, 0.449156, 0.420633, 0.433888, 0.440931, 0.425416, 0.442745, 0.432081, 0.424703, 0.423033, 0.427245, 0.429201, 0.43372, 0.43841, 0.437188, 0.431507, 0.439171, 0.446225, 0.448739, 0.433061, 0.412138, 0.428949, 0.429241, 0.437336, 0.437484, 0.413107, 0.43323, 0.430845, 0.432263, 0.435823, 0.422287, 0.424727, 0.419824, 0.434904, 0.423586, 0.437867], "curve_after": [0.682595, 0.429341, 0.476412, 0.459997, 0.39739, 0.354824, 0.370512, 0.471246, 0.458074, 0.376962, 0.483036, 0.463939, 0.405284, 0.406986, 0.434918, 0.450982, 0.422425, 0.435693, 0.442617, 0.427027, 0.44438, 0.433934, 0.426387, 0.424547, 0.428779, 0.430773, 0.435274, 0.439973, 0.438614, 0.432937, 0.44044, 0.447555, 0.450186, 0.434355, 0.413227, 0.429906, 0.430238, 0.438394, 0.438631, 0.413957, 0.434154, 0.431663, 0.433016, 0.436734, 0.42293, 0.425469, 0.420634, 0.435663, 0.424476, 0.438834]}, {"file": "SRpe0551657.fastq.gz", "curve_before": [0.66298, 0.415539, 0.465642, 0.440614, 0.384895, 0.337339, 0.359915, 0.458167, 0.447152, 0.364704, 0.458276, 0.442207, 0.382728, 0.389936, 0.412112, 0.436118, 0.413076, 0.430889, 0.428597, 0.407742, 0.41952, 0.41886, 0.403971, 0.406789, 0.416136, 0.419877, 0.411962, 0.424832, 0.425925, 0.426083, 0.418513, 0.435333, 0.432973, 0.419062, 0.396893, 0.413365, 0.420869, 0.422655, 0.415212, 0.403611, 0.424044, 0.415868, 0.421725, 0.42285, 0.417366, 0.413014, 0.410664, 0.42006, 0.416933, 0.430643], "curve_after": [0.668737, 0.418663, 0.469136, 0.443631, 0.387561, 0.339337, 0.362406, 0.46144, 0.450261, 0.367146, 0.461527, 0.445318, 0.385296, 0.392465, 0.414904, 0.438984, 0.41584, 0.433834, 0.431302, 0.410242, 0.421982, 0.42162, 0.40642, 0.409284, 0.418659, 0.422421, 0.41429, 0.427167, 0.428145, 0.428231, 0.420359, 0.437306, 0.43485, 0.420708, 0.398331, 0.414645, 0.42232, 0.423907, 0.416571, 0.404729, 0.425184, 0.416847, 0.42258, 0.42372, 0.418316, 0.41393, 0.411654, 0.421195, 0.41808, 0.431903]}];
        const maxLenGCBefore = 50;
        const maxLenGCAfter = 50;
        const gcLabelsBefore = Array.from({length: maxLenGCBefore}, (_, i) => i + 1);
        const gcLabelsAfter = Array.from({length: maxLenGCAfter}, (_, i) => i + 1);
        const plotlyTracesGCBefore = gcCurves.map((item, idx) => {
            const before = item.curve_before || [];
            const beforePad = before.concat(Array(maxLenGCBefore - before.length).fill(null));
            return {
                x: gcLabelsBefore,
                y: beforePad,
                mode: 'lines',
                name: item.file,
                line: { width: 1 }
            };
        });
        Plotly.newPlot('gcCurvePlotBefore', plotlyTracesGCBefore, {
            title: 'GC Content Curve (Read1, Before Filtering)',
            xaxis: { title: '' },
            yaxis: { title: 'GC %', rangemode: 'tozero' },
            legend: { orientation: 'h' },
            margin: { t: 50, l: 60, r: 30, b: 60 }
        }, {responsive: true});
        // Plotly GC content curves (after)
        const plotlyTracesGCAfter = gcCurves.map((item, idx) => {
            const after = item.curve_after || [];
            const afterPad = after.concat(Array(maxLenGCAfter - after.length).fill(null));
            return {
                x: gcLabelsAfter,
                y: afterPad,
                mode: 'lines',
                name: item.file,
                line: { width: 1 }
            };
        });
        Plotly.newPlot('gcCurvePlotAfter', plotlyTracesGCAfter, {
            title: 'GC Content Curve (Read1, After Filtering)',
            xaxis: { title: '' },
            yaxis: { title: 'GC %', rangemode: 'tozero' },
            legend: { orientation: 'h' },
            margin: { t: 50, l: 60, r: 30, b: 60 }
        }, {responsive: true});
        // Plotly mean quality and GC curves for read2 (if any)
        const meanQualCurvesR2 = [];
        const gcCurvesR2 = [];
        const maxLenBeforeR2 = 0;
        const maxLenAfterR2 = 0;
        const maxLenGCBeforeR2 = 0;
        const maxLenGCAfterR2 = 0;
        if (meanQualCurvesR2.length > 0 || gcCurvesR2.length > 0) {
            const qualLabelsBeforeR2 = Array.from({length: maxLenBeforeR2}, (_, i) => i + 1);
            const qualLabelsAfterR2 = Array.from({length: maxLenAfterR2}, (_, i) => i + 1);
            const gcLabelsBeforeR2 = Array.from({length: maxLenGCBeforeR2}, (_, i) => i + 1);
            const gcLabelsAfterR2 = Array.from({length: maxLenGCAfterR2}, (_, i) => i + 1);
            const plotlyTracesBeforeR2 = meanQualCurvesR2.map((item, idx) => {
                const before = item.curve_before || [];
                const beforePad = before.concat(Array(maxLenBeforeR2 - before.length).fill(null));
                return {
                    x: qualLabelsBeforeR2,
                    y: beforePad,
                    mode: 'lines',
                    name: item.file,
                    line: { width: 1 }
                };
            });
            Plotly.newPlot('meanQualPlotBeforeR2', plotlyTracesBeforeR2, {
                title: 'Mean Quality Curve (Read2, Before Filtering)',
                xaxis: { title: '' },
                yaxis: { title: 'Mean Quality', rangemode: 'tozero' },
                legend: { orientation: 'h' },
                margin: { t: 50, l: 60, r: 30, b: 60 }
            }, {responsive: true});
            const plotlyTracesAfterR2 = meanQualCurvesR2.map((item, idx) => {
                const after = item.curve_after || [];
                const afterPad = after.concat(Array(maxLenAfterR2 - after.length).fill(null));
                return {
                    x: qualLabelsAfterR2,
                    y: afterPad,
                    mode: 'lines',
                    name: item.file,
                    line: { width: 1 }
                };
            });
            Plotly.newPlot('meanQualPlotAfterR2', plotlyTracesAfterR2, {
                title: 'Mean Quality Curve (Read2, After Filtering)',
                xaxis: { title: '' },
                yaxis: { title: 'Mean Quality', rangemode: 'tozero' },
                legend: { orientation: 'h' },
                margin: { t: 50, l: 60, r: 30, b: 60 }
            }, {responsive: true});
            // GC content curves for read2
            const plotlyTracesGCBeforeR2 = gcCurvesR2.map((item, idx) => {
                const before = item.curve_before || [];
                const beforePad = before.concat(Array(maxLenGCBeforeR2 - before.length).fill(null));
                return {
                    x: gcLabelsBeforeR2,
                    y: beforePad,
                    mode: 'lines',
                    name: item.file,
                    line: { width: 1 }
                };
            });
            Plotly.newPlot('gcCurvePlotBeforeR2', plotlyTracesGCBeforeR2, {
                title: 'GC Content Curve (Read2, Before Filtering)',
                xaxis: { title: '' },
                yaxis: { title: 'GC %', rangemode: 'tozero' },
                legend: { orientation: 'h' },
                margin: { t: 50, l: 60, r: 30, b: 60 }
            }, {responsive: true});
            const plotlyTracesGCAfterR2 = gcCurvesR2.map((item, idx) => {
                const after = item.curve_after || [];
                const afterPad = after.concat(Array(maxLenGCAfterR2 - after.length).fill(null));
                return {
                    x: gcLabelsAfterR2,
                    y: afterPad,
                    mode: 'lines',
                    name: item.file,
                    line: { width: 1 }
                };
            });
            Plotly.newPlot('gcCurvePlotAfterR2', plotlyTracesGCAfterR2, {
                title: 'GC Content Curve (Read2, After Filtering)',
                xaxis: { title: '' },
                yaxis: { title: 'GC %', rangemode: 'tozero' },
                legend: { orientation: 'h' },
                margin: { t: 50, l: 60, r: 30, b: 60 }
            }, {responsive: true});
        }
        // Q20/Q30/Q40 chart (grouped bar)
        new Chart(document.getElementById('qRateChart'), {
            type: 'bar',
            data: {
                labels: files,
                datasets: [
                    { label: 'Q20 Rate (Before)', data: q20Before, backgroundColor: '#fab1a0' },
                    { label: 'Q20 Rate (After)', data: q20After, backgroundColor: '#e17055' },
                    { label: 'Q30 Rate (Before)', data: q30Before, backgroundColor: '#b2bec3' },
                    { label: 'Q30 Rate (After)', data: q30After, backgroundColor: '#2ecc71' }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { position: 'top' } },
                scales: { y: { beginAtZero: true, max: 100 } },
                animation: false
            }
        });
    </script>
</body>
</html>
